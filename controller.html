<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title></title>
        <script src="node_modules/phaser/build/phaser.min.js"></script>
        <script src="src/lib/phaser-virtual-joystick.min.js" type="text/javascript"></script>
        <script type="text/javascript" src="https://www.airconsole.com/api/airconsole-1.7.0.js"></script>
        <script
          src="https://code.jquery.com/jquery-1.12.4.min.js"
          integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ="
          crossorigin="anonymous"></script>
    </head>
    <body>

        <script type="text/javascript">
        $(function(){
          var game = new Phaser.Game(window.innerHeight, window.innerWidth, Phaser.CANVAS, 'phaser-example');
          var airconsole = new AirConsole({"orientation": "landscape"});
          var PhaserGame = function () {

              this.sprite;

              this.pad;

              this.stick;

              this.buttonA;

          };

          function sendMessge(val) {
              airconsole.message(AirConsole.SCREEN, val);
          }

          PhaserGame.prototype = {

              init: function () {

                  this.game.renderer.renderSession.roundPixels = true;
                  this.physics.startSystem(Phaser.Physics.ARCADE);

              },

              preload: function () {
                  this.load.atlas('dpad', 'assets/virtualjoystick/skins/dpad.png', 'assets/virtualjoystick/skins/dpad.json');
                  // this.load.image('ship', 'assets/virtualjoystick/thrust.png');
                  // this.load.image('bg', 'assets/virtualjoystick/sky2.png');

              },

              create: function () {

                  //this.add.image(0, 0, 'bg');
                  // this.sprite = this.add.sprite(400, 350, 'ship');
                  // this.sprite.texture.baseTexture.scaleMode = PIXI.NEAREST;
                  // this.sprite.scale.set(2);
                  // this.sprite.anchor.set(0.5);
                  // this.sprite.angle = -90;
                  // this.physics.arcade.enable(this.sprite);

                  this.pad = this.game.plugins.add(Phaser.VirtualJoystick);

                  this.stick = this.pad.addDPad(0, 0, 200, 'dpad');
                  this.stick.alignBottomLeft(20);

                  this.buttonA = this.pad.addButton(500, 520, 'dpad', 'button1-up', 'button1-down');
                  this.buttonA.alignBottomRight(20);
                  this.buttonA.onDown.add(this.pressButtonA, this);
              },
              pressButtonA: function () {

                  sendMessge('A');

              },
              update: function () {
                  var maxSpeed = 400;

                  if (this.stick.isDown)
                  {
                    if (this.stick.direction === Phaser.LEFT)
                    {
                        sendMessge('left');
                    }
                    else if (this.stick.direction === Phaser.RIGHT)
                    {
                        sendMessge('right');
                    }
                    else if (this.stick.direction === Phaser.UP)
                    {
                        sendMessge('up');
                    }
                    else if (this.stick.direction === Phaser.DOWN)
                    {
                        sendMessge('down');
                    }
                  }
                  else
                  {
                      sendMessge('stop');
                  }
              }

          };

          game.state.add('Game', PhaserGame, true);
          })
        </script>
    </body>
</html>
