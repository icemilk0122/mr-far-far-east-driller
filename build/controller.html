<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title></title>
        <script src="phaser.min.js"></script>
        <script src="lib/phaser-virtual-joystick.min.js" type="text/javascript"></script>
        <script type="text/javascript" src="https://www.airconsole.com/api/airconsole-1.7.0.js"></script>
        <script
          src="https://code.jquery.com/jquery-1.12.4.min.js"
          integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ="
          crossorigin="anonymous"></script>
    </head>
    <body>

        <script type="text/javascript">
        $(function(){
          var game = new Phaser.Game(window.innerHeight, window.innerWidth, Phaser.CANVAS, 'phaser-example');
          var airconsole = new AirConsole({"orientation": "landscape"});
          var PhaserGame = function () {

              this.sprite;

              this.pad;

              this.stick;

              this.buttonA;

          };

          function sendMessge(val) {
              airconsole.message(AirConsole.SCREEN, val);
          }

          PhaserGame.prototype = {

              init: function () {

              },

              preload: function () {
                  this.load.atlas('dpad', 'assets/virtualjoystick/skins/dpad.png', 'assets/virtualjoystick/skins/dpad.json');
              },

              create: function () {
                  this.pad = this.game.plugins.add(Phaser.VirtualJoystick);

                  this.stick = this.pad.addDPad(0, 0, 200, 'dpad');
                  this.stick.alignBottomLeft(20);
                  this.stick.onMove.add(this.moveSub, this);
                  this.stick.onUp.add(this.stopSub, this);

                  this.buttonA = this.pad.addButton(500, 520, 'dpad', 'button1-up', 'button1-down');
                  this.buttonA.alignBottomRight(20);
                  this.buttonA.onDown.add(this.pressButtonA, this);
              },
              pressButtonA: function () {

                  sendMessge('A');

              },
              moveSub: function () {
                if (this.stick.direction === Phaser.LEFT)
                {
                    sendMessge('left');
                }
                else if (this.stick.direction === Phaser.RIGHT)
                {
                    sendMessge('right');
                }
                else if (this.stick.direction === Phaser.UP)
                {
                    sendMessge('up');
                }
                else if (this.stick.direction === Phaser.DOWN)
                {
                    sendMessge('down');
                }

              },

              stopSub: function () {

                  sendMessge('stop');

              }
          };

          game.state.add('Game', PhaserGame, true);
          })
        </script>
    </body>
</html>
